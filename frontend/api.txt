
f0fId523BoSeUBy0
mongodb+srv://thoeurnpanha14_db_user:f0fId523BoSeUBy0@cluster0.bqie1ao.mongodb.net/?appName=Cluster0

v2 wPKh8kwhDsU9PyBb
mongodb+srv://sainicc01_db_user:wPKh8kwhDsU9PyBb@cluster0.y25sbxx.mongodb.net/?appName=Cluster0



<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MUSICE ID - Admin Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700;900&display=swap');
        
        body { 
            background-color: #020617; 
            color: #f8fafc; 
            font-family: 'Inter', sans-serif; 
            background: radial-gradient(circle at top right, #1e1b4b, #020617); 
            overflow-x: hidden; 
            background-attachment: fixed;
        }

        .glass-panel { 
            background: rgba(255, 255, 255, 0.03); 
            backdrop-filter: blur(12px); 
            border: 1px solid rgba(255, 255, 255, 0.08); 
        }

        .hidden-view { display: none !important; }

        .view-active {
            background: #1e293b !important;
            color: #3b82f6 !important;
            border-color: rgba(59, 130, 246, 0.3) !important;
        }

        .song-card { transition: all 0.3s ease; }
        .song-card:hover { border-color: rgba(59, 130, 246, 0.4); background: rgba(255, 255, 255, 0.05); }

        /* TOAST NOTIFICATION STYLING */
        #toast {
            visibility: hidden;
            min-width: 250px;
            background-color: #3b82f6;
            color: #fff;
            text-align: center;
            border-radius: 12px;
            padding: 16px;
            position: fixed;
            z-index: 1000;
            left: 50%;
            bottom: 30px;
            transform: translateX(-50%);
            font-weight: 700;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            opacity: 0;
            transition: opacity 0.3s, bottom 0.3s;
        }

        #toast.show {
            visibility: visible;
            opacity: 1;
            bottom: 50px;
        }

        .admin-list::-webkit-scrollbar { width: 4px; }
        .admin-list::-webkit-scrollbar-thumb { background: rgba(59, 130, 246, 0.5); border-radius: 10px; }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Toast Notification Element -->
    <div id="toast">
        <i class="fa-solid fa-circle-check"></i>
        <span id="toast-message">Copied to Clipboard!</span>
    </div>

    <!-- NAVIGATION -->
    <header class="flex justify-between items-center px-6 md:px-10 py-6">
        <div class="flex items-center gap-2 cursor-pointer" onclick="location.reload()">
            <span class="font-black text-xl tracking-tighter uppercase italic text-white">Musice<span class="text-blue-500">ID</span></span>
        </div>
        <button onclick="toggleAdminView()" id="adminBtn" class="px-5 py-2 glass-panel rounded-xl flex items-center justify-center hover:bg-white/10 transition text-sm font-bold gap-2">
            <i class="fa-solid fa-user-shield text-blue-400"></i> Admin Access
        </button>
    </header>

    <!-- SEARCH SECTION -->
    <section class="flex flex-col items-center pt-8 px-6 text-center">
        <h1 class="text-5xl md:text-7xl font-black mb-8 uppercase text-white tracking-tighter">Musice <span class="text-blue-500">ID</span></h1>
        <div class="relative w-full max-w-2xl mx-auto mb-12">
            <i class="fa-solid fa-magnifying-glass absolute left-5 top-1/2 -translate-y-1/2 text-gray-500 text-lg"></i>
            <input type="text" id="songSearch" oninput="searchSongs()" placeholder="Search library by name or ID..." 
                class="bg-white/5 border border-white/10 rounded-2xl py-4 pl-14 pr-6 w-full text-white text-lg focus:outline-none focus:border-blue-500 shadow-2xl">
        </div>
    </section>

    <!-- TOOLBAR -->
    <div class="max-w-7xl mx-auto w-full px-6 md:px-10 flex items-center justify-between mb-8 border-b border-white/5 pb-6">
        <div class="flex items-center gap-4">
            <h2 class="text-2xl font-bold">Library</h2>
            <span id="songCount" class="bg-blue-500/10 text-blue-400 border border-blue-500/20 px-3 py-1 rounded-lg text-[10px] font-bold uppercase tracking-widest">0 Items</span>
        </div>
        <div class="glass-panel p-1 rounded-xl flex gap-1">
            <button onclick="updateView('list')" id="listBtn" class="px-4 py-2 rounded-lg text-sm font-bold transition-all flex items-center gap-2 view-active">
                <i class="fa-solid fa-list"></i> List
            </button>
            <button onclick="updateView('grid')" id="gridBtn" class="px-4 py-2 rounded-lg text-sm font-bold transition-all flex items-center gap-2 text-gray-400 hover:text-white">
                <i class="fa-solid fa-grip"></i> Grid
            </button>
        </div>
    </div>

    <!-- MAIN CONTAINER -->
    <main class="max-w-7xl mx-auto w-full px-6 md:px-10 pb-20">
        <div id="song-container" class="flex flex-col gap-3 max-w-5xl mx-auto"></div>
    </main>

    <!-- LOGIN MODAL -->
    <div id="loginPage" class="fixed inset-0 z-[300] bg-slate-950/90 backdrop-blur-xl flex items-center justify-center hidden-view p-4">
        <div class="glass-panel p-10 rounded-[2.5rem] w-full max-w-sm text-center">
            <i class="fa-solid fa-lock text-blue-500 text-4xl mb-6"></i>
            <h2 class="text-2xl font-bold mb-8 text-white">Admin Login</h2>
            <input type="password" id="adminPass" placeholder="Password" class="w-full bg-white/5 border border-white/10 rounded-2xl py-4 px-4 mb-6 focus:outline-none focus:border-blue-500 text-center text-white">
            <button onclick="handleLogin()" class="w-full bg-blue-600 py-4 rounded-2xl font-bold hover:bg-blue-500 transition">Authorize</button>
            <button onclick="closeModals()" class="mt-4 text-gray-500 text-xs uppercase font-bold">Cancel</button>
        </div>
    </div>

    <!-- ADMIN DASHBOARD -->
    <div id="adminPanel" class="fixed inset-0 z-[300] bg-slate-950/95 backdrop-blur-2xl flex items-center justify-center hidden-view p-4">
        <div class="glass-panel p-8 rounded-[2.5rem] w-full max-w-6xl h-[85vh] flex flex-col md:flex-row gap-8 overflow-hidden">
            <div class="w-full md:w-1/3 space-y-6 overflow-y-auto pr-2 border-r border-white/5">
                <h2 id="formTitle" class="text-2xl font-bold text-blue-400">Add New Song</h2>
                <div class="space-y-4">
                    <input type="text" id="newSongName" placeholder="Song Name" class="w-full bg-white/5 border border-white/10 rounded-xl py-3 px-4 text-white">
                    <input type="text" id="newSongID" placeholder="Asset ID" class="w-full bg-white/5 border border-white/10 rounded-xl py-3 px-4 text-white">
                    <select id="imageMode" onchange="toggleImageInput()" class="w-full bg-white/5 border border-white/10 rounded-xl py-3 px-4 text-white">
                        <option value="auto">Default Image</option>
                        <option value="manual">Manual URL</option>
                    </select>
                    <input type="text" id="newImg" placeholder="Image URL" class="hidden w-full bg-white/5 border border-white/10 rounded-xl py-3 px-4 text-white mt-2">
                    <button id="submitBtn" onclick="saveSong()" class="w-full bg-blue-600 py-4 rounded-2xl font-bold hover:bg-blue-500 transition">Save to Library</button>
                    <button id="cancelEditBtn" onclick="resetForm()" class="hidden w-full bg-white/10 py-2 rounded-xl text-xs">Cancel Edit</button>
                </div>
                <button onclick="logout()" class="w-full text-red-500 text-xs font-bold uppercase mt-10">Logout Account</button>
            </div>
            <div class="flex-grow flex flex-col overflow-hidden">
                <h3 class="text-xl font-bold mb-6">Library Manager</h3>
                <div id="adminSongList" class="admin-list flex-grow overflow-y-auto space-y-3 pr-2"></div>
                <button onclick="closeModals()" class="w-full text-gray-500 text-sm py-4">Close</button>
            </div>
        </div>
    </div>

    <script>
        const API_URL = "http://127.0.0.1:8000";
        let allSongs = [];
        let viewType = 'list';
        let isLoggedIn = false;
        let editModeId = null;
        const defaultImg = "https://i.pinimg.com/736x/68/57/7a/68577aafbdc23a3dd61f89b57601d26f.jpg";

        // TOAST LOGIC
        function showToast(msg) {
            const toast = document.getElementById("toast");
            document.getElementById("toast-message").innerText = msg;
            toast.classList.add("show");
            setTimeout(() => { toast.classList.remove("show"); }, 2000);
        }

        // COPY LOGIC
        function copyID(e, id) {
            e.stopPropagation();
            navigator.clipboard.writeText(id).then(() => {
                const btn = e.currentTarget;
                const icon = btn.querySelector('i');
                const span = btn.querySelector('.btn-text'); // Only exists in List View

                const originalIcon = icon.className;
                
                // Visual feedback
                icon.className = 'fa-solid fa-check text-green-400';
                if(span) span.innerText = "Copied!";
                btn.classList.add('border-blue-500');

                showToast("ID " + id + " copied!");

                setTimeout(() => {
                    icon.className = originalIcon;
                    if(span) span.innerText = "Copy ID";
                    btn.classList.remove('border-blue-500');
                }, 1500);
            });
        }

        function updateView(type) {
            viewType = type;
            document.getElementById('listBtn').classList.toggle('view-active', type === 'list');
            document.getElementById('gridBtn').classList.toggle('view-active', type === 'grid');
            const container = document.getElementById('song-container');
            container.className = type === 'list' ? "flex flex-col gap-3 max-w-5xl mx-auto" : "grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6";
            renderPublicList(allSongs);
        }

        async function fetchSongs() {
            try {
                const res = await fetch(`${API_URL}/songs`);
                allSongs = await res.json();
                renderPublicList(allSongs);
                document.getElementById('songCount').innerText = `${allSongs.length} Items`;
            } catch (err) { console.error("Fetch error"); }
        }

        function renderPublicList(songs) {
            const container = document.getElementById('song-container');
            if(viewType === 'list') {
                container.innerHTML = songs.map(song => `
                    <div class="glass-panel p-3 rounded-2xl flex items-center gap-6 song-card">
                        <img src="${song.img}" class="w-16 h-16 rounded-xl object-cover shadow-lg">
                        <div class="flex-grow">
                            <h4 class="font-bold text-white text-lg">${song.name}</h4>
                            <p class="text-[10px] font-mono text-gray-500">ID: ${song.song_id_string}</p>
                        </div>
                        <button onclick="copyID(event, '${song.song_id_string}')" class="px-6 py-2 glass-panel rounded-xl text-xs font-bold hover:bg-blue-600 transition flex items-center gap-2">
                            <i class="fa-solid fa-copy"></i> <span class="btn-text">Copy ID</span>
                        </button>
                    </div>`).join('');
            } else {
                container.innerHTML = songs.map(song => `
                    <div class="glass-panel p-4 rounded-[2rem] flex flex-col song-card">
                        <div class="rounded-[1.5rem] overflow-hidden aspect-square mb-4"><img src="${song.img}" class="w-full h-full object-cover"></div>
                        <h4 class="font-bold truncate text-white mb-4 px-1">${song.name}</h4>
                        <div class="flex items-center justify-between px-1">
                            <span class="text-[10px] font-bold text-blue-400 bg-blue-500/10 px-3 py-1 rounded-lg border border-blue-500/20">ID: ${song.song_id_string}</span>
                            <button onclick="copyID(event, '${song.song_id_string}')" class="w-10 h-10 rounded-xl glass-panel flex items-center justify-center hover:bg-blue-600 transition">
                                <i class="fa-solid fa-copy text-xs"></i>
                            </button>
                        </div>
                    </div>`).join('');
            }
        }

        // Admin functionality
        async function handleLogin() {
            const pass = document.getElementById('adminPass').value;
            const res = await fetch(`${API_URL}/login`, {
                method: 'POST', headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ password: pass })
            });
            if (res.ok) {
                isLoggedIn = true; closeModals();
                document.getElementById('adminPanel').classList.remove('hidden-view');
                renderAdminList();
            } else { alert("Wrong Password"); }
        }

        function renderAdminList() {
            const list = document.getElementById('adminSongList');
            list.innerHTML = allSongs.map(song => `
                <div class="flex items-center gap-3 bg-white/5 p-4 rounded-2xl border border-white/5">
                    <img src="${song.img}" class="w-10 h-10 object-cover rounded-lg">
                    <div class="flex-grow overflow-hidden"><p class="text-xs font-bold truncate">${song.name}</p></div>
                    <div class="flex gap-2">
                        <button onclick="prepareEdit('${song.song_id_string}')" class="w-8 h-8 rounded-lg bg-blue-500/20 text-blue-400 flex items-center justify-center hover:bg-blue-500"><i class="fa-solid fa-pen text-[10px]"></i></button>
                        <button onclick="deleteSong('${song.song_id_string}')" class="w-8 h-8 rounded-lg bg-red-500/20 text-red-400 flex items-center justify-center hover:bg-red-500"><i class="fa-solid fa-trash text-[10px]"></i></button>
                    </div>
                </div>`).join('');
        }

        async function saveSong() {
            const name = document.getElementById('newSongName').value;
            const song_id_string = document.getElementById('newSongID').value;
            const mode = document.getElementById('imageMode').value;
            const manualImg = document.getElementById('newImg').value;
            const img = mode === 'auto' ? defaultImg : (manualImg || defaultImg);
            if(!name || !song_id_string) return alert("Fill Name and ID");
            const method = editModeId ? 'PUT' : 'POST';
            const url = editModeId ? `${API_URL}/songs/${editModeId}` : `${API_URL}/songs`;
            const res = await fetch(url, {
                method: method, headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ name, song_id_string, img })
            });
            if(res.ok) { resetForm(); fetchSongs(); }
        }

        async function deleteSong(id) {
            if(confirm("Delete?")) { await fetch(`${API_URL}/songs/${id}`, { method: 'DELETE' }); fetchSongs(); }
        }

        function prepareEdit(id) {
            const song = allSongs.find(s => s.song_id_string === id);
            editModeId = id;
            document.getElementById('newSongName').value = song.name;
            document.getElementById('newSongID').value = song.song_id_string;
            document.getElementById('newSongID').disabled = true;
            document.getElementById('formTitle').innerText = "Edit Song";
            document.getElementById('submitBtn').innerText = "Update";
            document.getElementById('cancelEditBtn').classList.remove('hidden');
        }

        function resetForm() {
            editModeId = null;
            document.getElementById('newSongName').value = "";
            document.getElementById('newSongID').value = "";
            document.getElementById('newSongID').disabled = false;
            document.getElementById('formTitle').innerText = "Add New Song";
            document.getElementById('submitBtn').innerText = "Save to Library";
            document.getElementById('cancelEditBtn').classList.add('hidden');
        }

        function toggleAdminView() { isLoggedIn ? document.getElementById('adminPanel').classList.remove('hidden-view') : document.getElementById('loginPage').classList.remove('hidden-view'); }
        function closeModals() { document.getElementById('loginPage').classList.add('hidden-view'); document.getElementById('adminPanel').classList.add('hidden-view'); }
        function logout() { isLoggedIn = false; closeModals(); }
        function toggleImageInput() { document.getElementById('newImg').classList.toggle('hidden', document.getElementById('imageMode').value === 'auto'); }
        function searchSongs() {
            const q = document.getElementById('songSearch').value.toLowerCase();
            renderPublicList(allSongs.filter(s => s.name.toLowerCase().includes(q) || s.song_id_string.includes(q)));
        }

        fetchSongs();
    </script>
</body>
</html>