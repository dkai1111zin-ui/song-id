<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸŽ€ Musice ID - Library</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Quicksand:wght@300;500;700&display=swap');
        
        body { 
            background-color: #fff5f7; 
            color: #7d5a5a; 
            font-family: 'Quicksand', sans-serif; 
            /* Soft Pink & Lavender Gradient */
            background: radial-gradient(circle at top right, #fee2e2, #f5f3ff, #fff5f7); 
            background-attachment: fixed;
            min-height: 100vh;
        }

        .glass-panel { 
            background: rgba(255, 255, 255, 0.5); 
            backdrop-filter: blur(10px); 
            border: 2px solid rgba(255, 182, 193, 0.3); 
            box-shadow: 0 8px 32px rgba(255, 182, 193, 0.1);
        }

        .view-active { 
            background: #ffb6c1 !important; 
            color: white !important; 
            border-color: #ff9fb2 !important; 
        }

        .song-card { 
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
            border-radius: 2rem;
        }
        
        .song-card:hover { 
            transform: scale(1.03);
            border-color: #ffb6c1; 
            background: rgba(255, 255, 255, 0.8);
            box-shadow: 0 15px 30px rgba(255, 182, 193, 0.3);
        }

        #toast {
            visibility: hidden; min-width: 250px; 
            background: #ffb6c1; color: #fff; text-align: center;
            border-radius: 50px; padding: 12px; position: fixed; z-index: 1000; left: 50%; bottom: 30px;
            transform: translateX(-50%); font-weight: 700; opacity: 0; transition: 0.3s;
            box-shadow: 0 10px 20px rgba(255, 182, 193, 0.4);
        }
        #toast.show { visibility: visible; opacity: 1; bottom: 50px; }

        /* Floating Sparkles Animation */
        @keyframes floating {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        .float-sparkle { animation: floating 3s ease-in-out infinite; }
        
        input::placeholder { color: #d1a7a7; }
    </style>
</head>
<body>
    <div id="toast"><span id="toast-message">Copied, bestie!</span> </div>

    <!-- HEADER -->
    <header class="flex justify-between items-center px-6 md:px-10 py-6">
        <div class="flex items-center gap-2 cursor-pointer" onclick="location.reload()">
            <span class="text-2xl font-bold tracking-tight text-pink-400">
                <i class="fa-solid fa-heart mr-1 text-pink-300"></i>Musice<span class="text-purple-400">ID</span>
            </span>
        </div>
        <a href="admin.html" class="px-5 py-2 glass-panel rounded-full flex items-center justify-center hover:bg-pink-100 transition text-sm font-bold gap-2 text-pink-500">
            <i class="fa-solid fa-wand-sparkles"></i> Admin 
        </a>
    </header>

    <!-- SEARCH SECTION -->
    <section class="flex flex-col items-center pt-8 px-6 text-center">
        <div class="float-sparkle mb-4">
        </div>
        <h1 class="text-5xl md:text-6xl font-bold mb-8 text-pink-400 tracking-tight">
            Dreamy <span class="text-purple-400">Library</span>
        </h1>
        <div class="relative w-full max-w-2xl mx-auto mb-12">
            <i class="fa-solid fa-magnifying-glass absolute left-6 top-1/2 -translate-y-1/2 text-pink-300 text-lg"></i>
            <input type="text" id="songSearch" oninput="searchSongs()" placeholder="Search for your favorite song... âœ¨" 
                class="bg-white/60 border-2 border-pink-100 rounded-full py-5 pl-16 pr-8 w-full text-pink-600 text-lg focus:outline-none focus:border-pink-300 shadow-inner">
        </div>
    </section>

    <!-- TOOLBAR -->
    <div class="max-w-7xl mx-auto w-full px-6 md:px-10 flex items-center justify-between mb-8 pb-6">
        <div class="flex items-center gap-4">
            <h2 class="text-xl font-bold text-pink-400/80">My Playlist</h2>
            <span id="songCount" class="bg-pink-100 text-pink-500 px-4 py-1 rounded-full text-xs font-bold uppercase tracking-widest">0 Songs</span>
        </div>
        <div class="glass-panel p-1.5 rounded-full flex gap-1">
            <button onclick="updateView('list')" id="listBtn" class="px-5 py-2 rounded-full text-sm font-bold transition-all view-active"><i class="fa-solid fa-bars"></i></button>
            <button onclick="updateView('grid')" id="gridBtn" class="px-5 py-2 rounded-full text-sm font-bold transition-all text-pink-300 hover:text-pink-500"><i class="fa-solid fa-clover"></i></button>
        </div>
    </div>

    <!-- MAIN CONTAINER -->
    <main class="max-w-7xl mx-auto w-full px-6 md:px-10 pb-20">
        <div id="song-container" class="flex flex-col gap-4 max-w-5xl mx-auto"></div>
    </main>

    <script>
        const API_URL = "https://song-id-v3f2.onrender.com";
        let allSongs = [];
        let viewType = 'list';

        function showToast(msg) {
            const toast = document.getElementById("toast");
            document.getElementById("toast-message").innerText = msg;
            toast.classList.add("show");
            setTimeout(() => { toast.classList.remove("show"); }, 2000);
        }

        function copyID(e, id) {
            e.stopPropagation();
            navigator.clipboard.writeText(id).then(() => {
                showToast("Copied ID: " + id + " ðŸŽ€");
            });
        }

        async function fetchSongs() {
            try {
                const res = await fetch(`${API_URL}/songs`);
                allSongs = await res.json();
                renderPublicList(allSongs);
                document.getElementById('songCount').innerText = `${allSongs.length} Songs`;
            } catch (err) { console.error("Server connection failed"); }
        }

        function renderPublicList(songs) {
            const container = document.getElementById('song-container');
            const defaultImg = "https://i.pinimg.com/736x/68/57/7a/68577aafbdc23a3dd61f89b57601d26f.jpg";

            if(viewType === 'list') {
                container.className = "flex flex-col gap-4 max-w-5xl mx-auto";
                container.innerHTML = songs.map(song => `
                    <div class="glass-panel p-4 rounded-[2rem] flex items-center gap-6 song-card">
                        <div class="relative">
                            <img src="${song.img || defaultImg}" class="w-20 h-20 rounded-[1.5rem] object-cover shadow-md">
                            <div class="absolute -top-2 -left-2 text-xl">ðŸŒ¸</div>
                        </div>
                        <div class="flex-grow">
                            <h4 class="font-bold text-pink-600 text-xl">${song.name}</h4>
                            <p class="text-xs font-bold text-purple-300 uppercase tracking-widest">ID: ${song.song_id_string}</p>
                        </div>
                        <button onclick="copyID(event, '${song.song_id_string}')" class="px-8 py-3 bg-pink-400 text-white rounded-full text-xs font-bold hover:bg-pink-500 shadow-lg shadow-pink-200 transition-all">
                            Copy ID
                        </button>
                    </div>`).join('');
            } else {
                container.className = "grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8";
                container.innerHTML = songs.map(song => `
                    <div class="glass-panel p-5 rounded-[3rem] flex flex-col song-card text-center">
                        <div class="rounded-[2.5rem] overflow-hidden aspect-square mb-5 border-4 border-white shadow-sm">
                            <img src="${song.img || defaultImg}" class="w-full h-full object-cover">
                        </div>
                        <h4 class="font-bold truncate text-pink-600 text-lg mb-2">${song.name}</h4>
                        <div class="flex items-center justify-center gap-3">
                            <span class="text-[11px] font-bold text-purple-400 bg-purple-50 px-4 py-1.5 rounded-full border border-purple-100">ID: ${song.song_id_string}</span>
                            <button onclick="copyID(event, '${song.song_id_string}')" class="w-10 h-10 rounded-full bg-pink-400 text-white flex items-center justify-center hover:bg-pink-500 shadow-md transition-all">
                                <i class="fa-solid fa-copy text-sm"></i>
                            </button>
                        </div>
                    </div>`).join('');
            }
        }

        function updateView(type) {
            viewType = type;
            document.getElementById('listBtn').classList.toggle('view-active', type === 'list');
            document.getElementById('gridBtn').classList.toggle('view-active', type === 'grid');
            renderPublicList(allSongs);
        }

        function searchSongs() {
            const q = document.getElementById('songSearch').value.toLowerCase();
            renderPublicList(allSongs.filter(s => s.name.toLowerCase().includes(q) || s.song_id_string.includes(q)));
        }

        fetchSongs();
    </script>
</body>
</html>